(torch) chan@chan-desktop:~/Desktop/DLD1$ python train.py --model resnetunet --dataset-type oversample
----------------------------------------------------------------
----------------------------------------------------------------
The number of train set: 19765
The number of valid set: 2197
----------------------------------------------------------------
Epoch 1/150
----------
LR 0.001
train: bce: 0.048525, dice_loss: 0.934240, loss: 0.982765
val: bce: 0.059957, dice_loss: 0.494715, loss: 0.554672
Validation loss decreased (inf --> 0.554672).  Saving best model ...
6m 1s
Epoch 2/150
----------
LR 0.001
train: bce: 0.054089, dice_loss: 0.502064, loss: 0.556153
val: bce: 0.052086, dice_loss: 0.491134, loss: 0.543220
Validation loss decreased (0.554672 --> 0.543220).  Saving best model ...
5m 56s
Epoch 3/150
----------
LR 0.001
train: bce: 0.051464, dice_loss: 0.501494, loss: 0.552958
val: bce: 0.050970, dice_loss: 0.490703, loss: 0.541673
Validation loss decreased (0.543220 --> 0.541673).  Saving best model ...
5m 54s
Epoch 4/150
----------
LR 0.001
train: bce: 0.049951, dice_loss: 0.501414, loss: 0.551365
val: bce: 0.048522, dice_loss: 0.491388, loss: 0.539909
Validation loss decreased (0.541673 --> 0.539909).  Saving best model ...
5m 55s
Epoch 5/150
----------
LR 0.001
train: bce: 0.049000, dice_loss: 0.501372, loss: 0.550371
val: bce: 0.049963, dice_loss: 0.489497, loss: 0.539460
Validation loss decreased (0.539909 --> 0.539460).  Saving best model ...
5m 55s
Epoch 6/150
----------
LR 0.001
train: bce: 0.048081, dice_loss: 0.501341, loss: 0.549421
val: bce: 0.047839, dice_loss: 0.490112, loss: 0.537951
Validation loss decreased (0.539460 --> 0.537951).  Saving best model ...
5m 55s
Epoch 7/150
----------
LR 0.001
train: bce: 0.047384, dice_loss: 0.501388, loss: 0.548772
val: bce: 0.047557, dice_loss: 0.489820, loss: 0.537377
Validation loss decreased (0.537951 --> 0.537377).  Saving best model ...
5m 55s
Epoch 8/150
----------
LR 0.001
train: bce: 0.046717, dice_loss: 0.501360, loss: 0.548077
val: bce: 0.044654, dice_loss: 0.491972, loss: 0.536626
Validation loss decreased (0.537377 --> 0.536626).  Saving best model ...
5m 55s
Epoch 9/150
----------
LR 0.001
train: bce: 0.045926, dice_loss: 0.501396, loss: 0.547323
val: bce: 0.049102, dice_loss: 0.488755, loss: 0.537857
EarlyStopping counter: 1 out of 30
5m 54s
Epoch 10/150
----------
LR 0.001
train: bce: 0.045168, dice_loss: 0.501350, loss: 0.546518
val: bce: 0.042351, dice_loss: 0.493089, loss: 0.535441
Validation loss decreased (0.536626 --> 0.535441).  Saving best model ...
5m 55s
Epoch 11/150
----------
LR 0.001
train: bce: 0.044606, dice_loss: 0.501393, loss: 0.545999
val: bce: 0.048363, dice_loss: 0.488636, loss: 0.536999
EarlyStopping counter: 1 out of 30
5m 54s
Epoch 12/150
----------
LR 0.001
train: bce: 0.044147, dice_loss: 0.501560, loss: 0.545707
val: bce: 0.042787, dice_loss: 0.491512, loss: 0.534299
Validation loss decreased (0.535441 --> 0.534299).  Saving best model ...
5m 55s
Epoch 13/150
----------
LR 0.001
train: bce: 0.042984, dice_loss: 0.501374, loss: 0.544359
val: bce: 0.043410, dice_loss: 0.489863, loss: 0.533273
Validation loss decreased (0.534299 --> 0.533273).  Saving best model ...
5m 55s
Epoch 14/150
----------
LR 0.001
train: bce: 0.042930, dice_loss: 0.501501, loss: 0.544431
val: bce: 0.039941, dice_loss: 0.493498, loss: 0.533439
EarlyStopping counter: 1 out of 30
5m 54s
Epoch 15/150
----------
LR 0.001
train: bce: 0.043132, dice_loss: 0.500604, loss: 0.543737
val: bce: 0.035870, dice_loss: 0.503935, loss: 0.539805
EarlyStopping counter: 2 out of 30
5m 54s
Epoch 16/150
----------
LR 0.001
train: bce: 0.042257, dice_loss: 0.499361, loss: 0.541618
val: bce: 0.044644, dice_loss: 0.487399, loss: 0.532044
Validation loss decreased (0.533273 --> 0.532044).  Saving best model ...
5m 55s
Epoch 17/150
----------
LR 0.001
train: bce: 0.041870, dice_loss: 0.498788, loss: 0.540658
val: bce: 0.038688, dice_loss: 0.488048, loss: 0.526736
Validation loss decreased (0.532044 --> 0.526736).  Saving best model ...
5m 55s
Epoch 18/150
----------
LR 0.001
train: bce: 0.041200, dice_loss: 0.498037, loss: 0.539237
val: bce: 0.042011, dice_loss: 0.482894, loss: 0.524906
Validation loss decreased (0.526736 --> 0.524906).  Saving best model ...
5m 55s
Epoch 19/150
----------
LR 0.001
train: bce: 0.040988, dice_loss: 0.497162, loss: 0.538150
val: bce: 0.035866, dice_loss: 0.495424, loss: 0.531290
EarlyStopping counter: 1 out of 30
5m 54s
Epoch 20/150
----------
LR 0.001
train: bce: 0.040866, dice_loss: 0.494453, loss: 0.535319
val: bce: 0.047227, dice_loss: 0.486205, loss: 0.533432
EarlyStopping counter: 2 out of 30
5m 54s
Epoch 21/150
----------
LR 0.001
train: bce: 0.041198, dice_loss: 0.493480, loss: 0.534678
val: bce: 0.034919, dice_loss: 0.495520, loss: 0.530439
EarlyStopping counter: 3 out of 30
5m 54s
Epoch 22/150
----------
LR 0.001
train: bce: 0.040945, dice_loss: 0.490340, loss: 0.531285
val: bce: 0.033890, dice_loss: 0.482217, loss: 0.516107
Validation loss decreased (0.524906 --> 0.516107).  Saving best model ...
5m 55s
Epoch 23/150
----------
LR 0.001
train: bce: 0.039919, dice_loss: 0.487151, loss: 0.527069
val: bce: 0.065126, dice_loss: 0.481403, loss: 0.546528
EarlyStopping counter: 1 out of 30
5m 54s
Epoch 24/150
----------
LR 0.001
train: bce: 0.039315, dice_loss: 0.481554, loss: 0.520868
val: bce: 0.052240, dice_loss: 0.474538, loss: 0.526778
EarlyStopping counter: 2 out of 30
5m 54s
Epoch 25/150
----------
LR 0.001
train: bce: 0.037901, dice_loss: 0.476938, loss: 0.514839
val: bce: 0.042444, dice_loss: 0.454430, loss: 0.496874
Validation loss decreased (0.516107 --> 0.496874).  Saving best model ...
5m 55s
Epoch 26/150
----------
LR 0.001
train: bce: 0.042387, dice_loss: 0.485940, loss: 0.528327
val: bce: 0.034759, dice_loss: 0.460793, loss: 0.495551
Validation loss decreased (0.496874 --> 0.495551).  Saving best model ...
5m 54s
Epoch 27/150
----------
LR 0.001
train: bce: 0.037529, dice_loss: 0.474076, loss: 0.511605
val: bce: 0.031718, dice_loss: 0.458809, loss: 0.490527
Validation loss decreased (0.495551 --> 0.490527).  Saving best model ...
5m 54s
Epoch 28/150
----------
LR 0.001
train: bce: 0.036792, dice_loss: 0.469144, loss: 0.505936
val: bce: 0.032806, dice_loss: 0.448147, loss: 0.480953
Validation loss decreased (0.490527 --> 0.480953).  Saving best model ...
5m 54s
Epoch 29/150
----------
LR 0.001
train: bce: 0.036112, dice_loss: 0.466196, loss: 0.502308
val: bce: 0.035589, dice_loss: 0.444048, loss: 0.479637
Validation loss decreased (0.480953 --> 0.479637).  Saving best model ...
5m 54s
Epoch 30/150
----------
LR 0.001
train: bce: 0.034208, dice_loss: 0.458127, loss: 0.492334
val: bce: 0.031793, dice_loss: 0.429111, loss: 0.460904
Validation loss decreased (0.479637 --> 0.460904).  Saving best model ...
5m 54s
Epoch 31/150
----------
LR 0.001
train: bce: 0.034554, dice_loss: 0.456488, loss: 0.491042
val: bce: 0.031115, dice_loss: 0.446149, loss: 0.477264
EarlyStopping counter: 1 out of 30
5m 54s
Epoch 32/150
----------
LR 0.001
train: bce: 0.034041, dice_loss: 0.452486, loss: 0.486526
val: bce: 0.031892, dice_loss: 0.450560, loss: 0.482452
EarlyStopping counter: 2 out of 30
5m 54s
Epoch 33/150
----------
LR 0.001
train: bce: 0.032325, dice_loss: 0.443278, loss: 0.475602
val: bce: 0.028142, dice_loss: 0.423071, loss: 0.451213
Validation loss decreased (0.460904 --> 0.451213).  Saving best model ...
5m 54s
Epoch 34/150
----------
LR 0.001
train: bce: 0.034152, dice_loss: 0.442111, loss: 0.476263
val: bce: 0.029568, dice_loss: 0.413210, loss: 0.442778
Validation loss decreased (0.451213 --> 0.442778).  Saving best model ...
5m 54s
Epoch 35/150
----------
LR 0.001
train: bce: 0.032584, dice_loss: 0.438871, loss: 0.471455
val: bce: 0.032086, dice_loss: 0.423418, loss: 0.455505
EarlyStopping counter: 1 out of 30
5m 54s
Epoch 36/150
----------
LR 0.001
train: bce: 0.031195, dice_loss: 0.429056, loss: 0.460251
val: bce: 0.029929, dice_loss: 0.412305, loss: 0.442234
Validation loss decreased (0.442778 --> 0.442234).  Saving best model ...
5m 54s
Epoch 37/150
----------
LR 0.001
train: bce: 0.031283, dice_loss: 0.429278, loss: 0.460561
val: bce: 0.024613, dice_loss: 0.419154, loss: 0.443766
EarlyStopping counter: 1 out of 30
5m 54s
Epoch 38/150
----------
LR 0.001
train: bce: 0.030314, dice_loss: 0.419882, loss: 0.450196
val: bce: 0.029983, dice_loss: 0.391827, loss: 0.421810
Validation loss decreased (0.442234 --> 0.421810).  Saving best model ...
5m 54s
Epoch 39/150
----------
LR 0.001
train: bce: 0.030759, dice_loss: 0.416899, loss: 0.447659
val: bce: 0.025034, dice_loss: 0.397031, loss: 0.422064
EarlyStopping counter: 1 out of 30
5m 53s
Epoch 40/150
----------
LR 0.001
train: bce: 0.028722, dice_loss: 0.410442, loss: 0.439165
val: bce: 0.029625, dice_loss: 0.396194, loss: 0.425819
EarlyStopping counter: 2 out of 30
5m 53s
Epoch 41/150
----------
LR 0.001
train: bce: 0.029431, dice_loss: 0.409137, loss: 0.438567
val: bce: 0.023472, dice_loss: 0.404868, loss: 0.428341
EarlyStopping counter: 3 out of 30
5m 53s
Epoch 42/150
----------
LR 0.001
train: bce: 0.028979, dice_loss: 0.404108, loss: 0.433088
val: bce: 0.027192, dice_loss: 0.386502, loss: 0.413694
Validation loss decreased (0.421810 --> 0.413694).  Saving best model ...
5m 54s
Epoch 43/150
----------
LR 0.001
train: bce: 0.027966, dice_loss: 0.398097, loss: 0.426063
val: bce: 0.027051, dice_loss: 0.385172, loss: 0.412223
Validation loss decreased (0.413694 --> 0.412223).  Saving best model ...
5m 54s
Epoch 44/150
----------
LR 0.001
train: bce: 0.028304, dice_loss: 0.399290, loss: 0.427594
val: bce: 0.024020, dice_loss: 0.363618, loss: 0.387638
Validation loss decreased (0.412223 --> 0.387638).  Saving best model ...
5m 55s
Epoch 45/150
----------
LR 0.001
train: bce: 0.026780, dice_loss: 0.388674, loss: 0.415454
val: bce: 0.022192, dice_loss: 0.363453, loss: 0.385645
Validation loss decreased (0.387638 --> 0.385645).  Saving best model ...
5m 54s
Epoch 46/150
----------
LR 0.001
train: bce: 0.027006, dice_loss: 0.388171, loss: 0.415176
val: bce: 0.025295, dice_loss: 0.371599, loss: 0.396895
EarlyStopping counter: 1 out of 30
5m 53s
Epoch 47/150
----------
LR 0.001
train: bce: 0.025904, dice_loss: 0.381711, loss: 0.407615
val: bce: 0.026092, dice_loss: 0.359491, loss: 0.385583
Validation loss decreased (0.385645 --> 0.385583).  Saving best model ...
5m 54s
Epoch 48/150
----------
LR 0.001
train: bce: 0.025924, dice_loss: 0.381121, loss: 0.407045
val: bce: 0.025306, dice_loss: 0.362506, loss: 0.387812
EarlyStopping counter: 1 out of 30
5m 53s
Epoch 49/150
----------
LR 0.001
train: bce: 0.024422, dice_loss: 0.370752, loss: 0.395174
val: bce: 0.020766, dice_loss: 0.336085, loss: 0.356851
Validation loss decreased (0.385583 --> 0.356851).  Saving best model ...
5m 54s
Epoch 50/150
----------
LR 0.001
train: bce: 0.023787, dice_loss: 0.366289, loss: 0.390076
val: bce: 0.023199, dice_loss: 0.368068, loss: 0.391268
EarlyStopping counter: 1 out of 30
5m 53s
Epoch 51/150
----------
LR 0.001
train: bce: 0.024174, dice_loss: 0.364425, loss: 0.388599
val: bce: 0.021083, dice_loss: 0.358018, loss: 0.379101
EarlyStopping counter: 2 out of 30
5m 53s
Epoch 52/150
----------
LR 0.001
train: bce: 0.024338, dice_loss: 0.363637, loss: 0.387975
val: bce: 0.022049, dice_loss: 0.330926, loss: 0.352975
Validation loss decreased (0.356851 --> 0.352975).  Saving best model ...
5m 54s
Epoch 53/150
----------
LR 0.001
train: bce: 0.023885, dice_loss: 0.358805, loss: 0.382690
val: bce: 0.024810, dice_loss: 0.367201, loss: 0.392011
EarlyStopping counter: 1 out of 30
5m 53s
Epoch 54/150
----------
LR 0.001
train: bce: 0.023942, dice_loss: 0.361400, loss: 0.385342
val: bce: 0.021330, dice_loss: 0.335894, loss: 0.357224
EarlyStopping counter: 2 out of 30
5m 53s
Epoch 55/150
----------
LR 0.001
train: bce: 0.022078, dice_loss: 0.343425, loss: 0.365503
val: bce: 0.022081, dice_loss: 0.324881, loss: 0.346962
Validation loss decreased (0.352975 --> 0.346962).  Saving best model ...
5m 53s
Epoch 56/150
----------
LR 0.001
train: bce: 0.021977, dice_loss: 0.344811, loss: 0.366788
val: bce: 0.023727, dice_loss: 0.335055, loss: 0.358782
EarlyStopping counter: 1 out of 30
5m 53s
Epoch 57/150
----------
LR 0.001
train: bce: 0.022457, dice_loss: 0.344971, loss: 0.367428
val: bce: 0.024549, dice_loss: 0.353079, loss: 0.377628
EarlyStopping counter: 2 out of 30
5m 53s
Epoch 58/150
----------
LR 0.001
train: bce: 0.021747, dice_loss: 0.341256, loss: 0.363003
val: bce: 0.019825, dice_loss: 0.326081, loss: 0.345907
Validation loss decreased (0.346962 --> 0.345907).  Saving best model ...
5m 53s
Epoch 59/150
----------
LR 0.001
train: bce: 0.021105, dice_loss: 0.337163, loss: 0.358269
val: bce: 0.022500, dice_loss: 0.317257, loss: 0.339757
Validation loss decreased (0.345907 --> 0.339757).  Saving best model ...
5m 54s
Epoch 60/150
----------
LR 0.001
train: bce: 0.021733, dice_loss: 0.339208, loss: 0.360941
val: bce: 0.019949, dice_loss: 0.312721, loss: 0.332670
Validation loss decreased (0.339757 --> 0.332670).  Saving best model ...
5m 54s
Epoch 61/150
----------
LR 0.001
train: bce: 0.021122, dice_loss: 0.331425, loss: 0.352548
val: bce: 0.017474, dice_loss: 0.334404, loss: 0.351878
EarlyStopping counter: 1 out of 30
5m 53s
Epoch 62/150
----------
LR 0.001
train: bce: 0.020998, dice_loss: 0.330420, loss: 0.351418
val: bce: 0.019046, dice_loss: 0.301284, loss: 0.320330
Validation loss decreased (0.332670 --> 0.320330).  Saving best model ...
5m 54s
Epoch 63/150
----------
LR 0.001
train: bce: 0.021609, dice_loss: 0.335088, loss: 0.356697
val: bce: 0.020650, dice_loss: 0.307211, loss: 0.327861
EarlyStopping counter: 1 out of 30
5m 53s
Epoch 64/150
----------
LR 0.001
train: bce: 0.020201, dice_loss: 0.323762, loss: 0.343963
val: bce: 0.021908, dice_loss: 0.310533, loss: 0.332441
EarlyStopping counter: 2 out of 30
5m 53s
Epoch 65/150
----------
LR 0.001
train: bce: 0.020551, dice_loss: 0.321173, loss: 0.341724
val: bce: 0.024514, dice_loss: 0.319518, loss: 0.344032
EarlyStopping counter: 3 out of 30
5m 53s
Epoch 66/150
----------
LR 0.001
train: bce: 0.020470, dice_loss: 0.322120, loss: 0.342590
val: bce: 0.017119, dice_loss: 0.293425, loss: 0.310543
Validation loss decreased (0.320330 --> 0.310543).  Saving best model ...
5m 53s
Epoch 67/150
----------
LR 0.001
train: bce: 0.019453, dice_loss: 0.314234, loss: 0.333687
val: bce: 0.018382, dice_loss: 0.297956, loss: 0.316338
EarlyStopping counter: 1 out of 30
5m 53s
Epoch 68/150
----------
LR 0.001
train: bce: 0.019352, dice_loss: 0.312869, loss: 0.332221
val: bce: 0.019482, dice_loss: 0.300538, loss: 0.320020
EarlyStopping counter: 2 out of 30
5m 53s
Epoch 69/150
----------
LR 0.001
train: bce: 0.018586, dice_loss: 0.305273, loss: 0.323859
val: bce: 0.018877, dice_loss: 0.287837, loss: 0.306714
Validation loss decreased (0.310543 --> 0.306714).  Saving best model ...
5m 54s
Epoch 70/150
----------
LR 0.001
train: bce: 0.018562, dice_loss: 0.304918, loss: 0.323480
val: bce: 0.017222, dice_loss: 0.302226, loss: 0.319448
EarlyStopping counter: 1 out of 30
5m 53s
Epoch 71/150
----------
LR 0.001
train: bce: 0.018420, dice_loss: 0.299946, loss: 0.318366
val: bce: 0.019173, dice_loss: 0.287718, loss: 0.306891
EarlyStopping counter: 2 out of 30
5m 53s
Epoch 72/150
----------
LR 0.001
train: bce: 0.018361, dice_loss: 0.301736, loss: 0.320097
val: bce: 0.019157, dice_loss: 0.292693, loss: 0.311849
EarlyStopping counter: 3 out of 30
5m 53s
Epoch 73/150
----------
LR 0.001
train: bce: 0.018409, dice_loss: 0.299921, loss: 0.318330
val: bce: 0.019450, dice_loss: 0.289709, loss: 0.309159
EarlyStopping counter: 4 out of 30
5m 53s
Epoch 74/150
----------
LR 0.001
train: bce: 0.018301, dice_loss: 0.301029, loss: 0.319330
val: bce: 0.015331, dice_loss: 0.279832, loss: 0.295163
Validation loss decreased (0.306714 --> 0.295163).  Saving best model ...
5m 54s
Epoch 75/150
----------
LR 0.001
train: bce: 0.017903, dice_loss: 0.296551, loss: 0.314454
val: bce: 0.015769, dice_loss: 0.285339, loss: 0.301108
EarlyStopping counter: 1 out of 30
5m 53s
Epoch 76/150
----------
LR 0.001
train: bce: 0.018663, dice_loss: 0.301238, loss: 0.319901
val: bce: 0.017241, dice_loss: 0.281854, loss: 0.299095
EarlyStopping counter: 2 out of 30
5m 54s
Epoch 77/150
----------
LR 0.001
train: bce: 0.017244, dice_loss: 0.288274, loss: 0.305518
val: bce: 0.015048, dice_loss: 0.275719, loss: 0.290767
Validation loss decreased (0.295163 --> 0.290767).  Saving best model ...
5m 54s
Epoch 78/150
----------
LR 0.001
train: bce: 0.017581, dice_loss: 0.291833, loss: 0.309414
val: bce: 0.017271, dice_loss: 0.316313, loss: 0.333584
EarlyStopping counter: 1 out of 30
5m 53s
Epoch 79/150
----------
LR 0.001
train: bce: 0.017232, dice_loss: 0.283444, loss: 0.300676
val: bce: 0.016394, dice_loss: 0.270691, loss: 0.287085
Validation loss decreased (0.290767 --> 0.287085).  Saving best model ...
5m 54s
Epoch 80/150
----------
LR 0.001
train: bce: 0.017330, dice_loss: 0.283023, loss: 0.300354
val: bce: 0.017413, dice_loss: 0.266711, loss: 0.284124
Validation loss decreased (0.287085 --> 0.284124).  Saving best model ...
5m 54s
Epoch 81/150
----------
LR 0.001
train: bce: 0.017350, dice_loss: 0.286925, loss: 0.304275
val: bce: 0.015104, dice_loss: 0.262413, loss: 0.277517
Validation loss decreased (0.284124 --> 0.277517).  Saving best model ...
5m 54s
Epoch 82/150
----------
LR 0.001
train: bce: 0.016658, dice_loss: 0.276997, loss: 0.293654
val: bce: 0.017533, dice_loss: 0.269074, loss: 0.286607
EarlyStopping counter: 1 out of 30
5m 53s
Epoch 83/150
----------
LR 0.001
train: bce: 0.016843, dice_loss: 0.278479, loss: 0.295322
val: bce: 0.014644, dice_loss: 0.268612, loss: 0.283256
EarlyStopping counter: 2 out of 30
5m 54s
Epoch 84/150
----------
LR 0.001
train: bce: 0.016706, dice_loss: 0.274494, loss: 0.291200
val: bce: 0.017521, dice_loss: 0.279083, loss: 0.296604
EarlyStopping counter: 3 out of 30
5m 54s
Epoch 85/150
----------
LR 0.001
train: bce: 0.017347, dice_loss: 0.280109, loss: 0.297455
val: bce: 0.018876, dice_loss: 0.275864, loss: 0.294740
EarlyStopping counter: 4 out of 30
6m 3s
Epoch 86/150
----------
LR 0.001
train: bce: 0.017202, dice_loss: 0.282442, loss: 0.299644
val: bce: 0.017848, dice_loss: 0.272226, loss: 0.290074
EarlyStopping counter: 5 out of 30
6m 7s
Epoch 87/150
----------
LR 0.001
train: bce: 0.016237, dice_loss: 0.272051, loss: 0.288288
val: bce: 0.016795, dice_loss: 0.268999, loss: 0.285794
EarlyStopping counter: 6 out of 30
6m 1s
Epoch 88/150
----------
LR 0.001
train: bce: 0.015986, dice_loss: 0.270886, loss: 0.286872
val: bce: 0.014696, dice_loss: 0.272022, loss: 0.286718
EarlyStopping counter: 7 out of 30
6m 9s
Epoch 89/150
----------
LR 0.001
train: bce: 0.016119, dice_loss: 0.271563, loss: 0.287683
val: bce: 0.016432, dice_loss: 0.259309, loss: 0.275740
Validation loss decreased (0.277517 --> 0.275740).  Saving best model ...
6m 4s
Epoch 90/150
----------
LR 0.001
train: bce: 0.015708, dice_loss: 0.269514, loss: 0.285221
val: bce: 0.016007, dice_loss: 0.249833, loss: 0.265840
Validation loss decreased (0.275740 --> 0.265840).  Saving best model ...
6m 1s
Epoch 91/150
----------
LR 0.001
train: bce: 0.015224, dice_loss: 0.263730, loss: 0.278953
val: bce: 0.013044, dice_loss: 0.248882, loss: 0.261926
Validation loss decreased (0.265840 --> 0.261926).  Saving best model ...
5m 56s
Epoch 92/150
----------
LR 0.001
train: bce: 0.015466, dice_loss: 0.267574, loss: 0.283040
val: bce: 0.015226, dice_loss: 0.253381, loss: 0.268607
EarlyStopping counter: 1 out of 30
5m 56s
Epoch 93/150
----------
LR 0.001
train: bce: 0.015409, dice_loss: 0.264077, loss: 0.279486
val: bce: 0.014702, dice_loss: 0.257847, loss: 0.272549
EarlyStopping counter: 2 out of 30
5m 55s
Epoch 94/150
----------
LR 0.001
train: bce: 0.015982, dice_loss: 0.265616, loss: 0.281598
val: bce: 0.014607, dice_loss: 0.243826, loss: 0.258433
Validation loss decreased (0.261926 --> 0.258433).  Saving best model ...
5m 57s
Epoch 95/150
----------
LR 0.001
train: bce: 0.015635, dice_loss: 0.259790, loss: 0.275425
val: bce: 0.015917, dice_loss: 0.247135, loss: 0.263051
EarlyStopping counter: 1 out of 30
6m 0s
Epoch 96/150
----------
LR 0.001
train: bce: 0.015159, dice_loss: 0.260450, loss: 0.275609
val: bce: 0.016127, dice_loss: 0.256654, loss: 0.272781
EarlyStopping counter: 2 out of 30
5m 55s
Epoch 97/150
----------
LR 0.001
train: bce: 0.015447, dice_loss: 0.260873, loss: 0.276319
val: bce: 0.014097, dice_loss: 0.249637, loss: 0.263734
EarlyStopping counter: 3 out of 30
5m 54s
Epoch 98/150
----------
LR 0.001
train: bce: 0.015513, dice_loss: 0.258926, loss: 0.274439
val: bce: 0.014464, dice_loss: 0.241831, loss: 0.256295
Validation loss decreased (0.258433 --> 0.256295).  Saving best model ...
5m 55s
Epoch 99/150
----------
LR 0.001
train: bce: 0.015186, dice_loss: 0.256951, loss: 0.272137
val: bce: 0.013786, dice_loss: 0.237096, loss: 0.250882
Validation loss decreased (0.256295 --> 0.250882).  Saving best model ...
5m 54s
Epoch 100/150
----------
LR 0.001
train: bce: 0.014807, dice_loss: 0.254182, loss: 0.268988
val: bce: 0.012683, dice_loss: 0.235691, loss: 0.248374
Validation loss decreased (0.250882 --> 0.248374).  Saving best model ...
6m 3s
Epoch 101/150
----------
LR 0.001
train: bce: 0.014654, dice_loss: 0.254423, loss: 0.269078
val: bce: 0.013814, dice_loss: 0.240359, loss: 0.254173
EarlyStopping counter: 1 out of 30
6m 4s
Epoch 102/150
----------
LR 0.001
train: bce: 0.014133, dice_loss: 0.248301, loss: 0.262434
val: bce: 0.014273, dice_loss: 0.234450, loss: 0.248723
EarlyStopping counter: 2 out of 30
6m 4s
Epoch 103/150
----------
LR 0.001
train: bce: 0.014362, dice_loss: 0.249249, loss: 0.263611
val: bce: 0.013937, dice_loss: 0.242135, loss: 0.256072
EarlyStopping counter: 3 out of 30
6m 1s
Epoch 104/150
----------
LR 0.001
train: bce: 0.013947, dice_loss: 0.248697, loss: 0.262644
val: bce: 0.014299, dice_loss: 0.247386, loss: 0.261684
EarlyStopping counter: 4 out of 30
6m 6s
Epoch 105/150
----------
LR 0.001
train: bce: 0.014575, dice_loss: 0.247190, loss: 0.261765
val: bce: 0.015501, dice_loss: 0.235809, loss: 0.251310
EarlyStopping counter: 5 out of 30
6m 8s
Epoch 106/150
----------
LR 0.001
train: bce: 0.014866, dice_loss: 0.249438, loss: 0.264304
val: bce: 0.015126, dice_loss: 0.239005, loss: 0.254131
EarlyStopping counter: 6 out of 30
6m 6s
Epoch 107/150
----------
LR 0.001
train: bce: 0.014559, dice_loss: 0.247576, loss: 0.262134
val: bce: 0.013280, dice_loss: 0.238717, loss: 0.251997
EarlyStopping counter: 7 out of 30
6m 7s
Epoch 108/150
----------
LR 0.001
train: bce: 0.013989, dice_loss: 0.245010, loss: 0.258998
val: bce: 0.013810, dice_loss: 0.234166, loss: 0.247976
Validation loss decreased (0.248374 --> 0.247976).  Saving best model ...
6m 7s
Epoch 109/150
----------
LR 0.001
train: bce: 0.014115, dice_loss: 0.241972, loss: 0.256087
val: bce: 0.014268, dice_loss: 0.232139, loss: 0.246407
Validation loss decreased (0.247976 --> 0.246407).  Saving best model ...
6m 6s
Epoch 110/150
----------
LR 0.001
train: bce: 0.013829, dice_loss: 0.237391, loss: 0.251220
val: bce: 0.012679, dice_loss: 0.224671, loss: 0.237350
Validation loss decreased (0.246407 --> 0.237350).  Saving best model ...
6m 17s
Epoch 111/150
----------
LR 0.001
train: bce: 0.014278, dice_loss: 0.244491, loss: 0.258770
val: bce: 0.013389, dice_loss: 0.241096, loss: 0.254485
EarlyStopping counter: 1 out of 30
6m 7s
Epoch 112/150
----------
LR 0.001
train: bce: 0.013677, dice_loss: 0.239580, loss: 0.253256
val: bce: 0.013251, dice_loss: 0.229911, loss: 0.243162
EarlyStopping counter: 2 out of 30
6m 6s
Epoch 113/150
----------
LR 0.001
train: bce: 0.013870, dice_loss: 0.239497, loss: 0.253367
val: bce: 0.012887, dice_loss: 0.222969, loss: 0.235856
Validation loss decreased (0.237350 --> 0.235856).  Saving best model ...
6m 5s
Epoch 114/150
----------
LR 0.001
train: bce: 0.013999, dice_loss: 0.237044, loss: 0.251043
val: bce: 0.011629, dice_loss: 0.227020, loss: 0.238649
EarlyStopping counter: 1 out of 30
6m 4s
Epoch 115/150
----------
LR 0.001
train: bce: 0.013194, dice_loss: 0.233428, loss: 0.246623
val: bce: 0.013209, dice_loss: 0.234124, loss: 0.247333
EarlyStopping counter: 2 out of 30
6m 7s
Epoch 116/150
----------
LR 0.001
train: bce: 0.013679, dice_loss: 0.233138, loss: 0.246816
val: bce: 0.011868, dice_loss: 0.217616, loss: 0.229484
Validation loss decreased (0.235856 --> 0.229484).  Saving best model ...
6m 1s
Epoch 117/150
----------
LR 0.001
train: bce: 0.013157, dice_loss: 0.231740, loss: 0.244897
val: bce: 0.012427, dice_loss: 0.220727, loss: 0.233154
EarlyStopping counter: 1 out of 30
5m 56s
Epoch 118/150
----------
LR 0.001
train: bce: 0.013622, dice_loss: 0.232608, loss: 0.246230
val: bce: 0.019118, dice_loss: 0.248056, loss: 0.267175
EarlyStopping counter: 2 out of 30
5m 56s
Epoch 119/150
----------
LR 0.001
train: bce: 0.012830, dice_loss: 0.226707, loss: 0.239537
val: bce: 0.012217, dice_loss: 0.225263, loss: 0.237480
EarlyStopping counter: 3 out of 30
5m 55s
Epoch 120/150
----------
LR 0.001
train: bce: 0.013726, dice_loss: 0.236216, loss: 0.249943
val: bce: 0.012756, dice_loss: 0.228209, loss: 0.240964
EarlyStopping counter: 4 out of 30
5m 54s
Epoch 121/150
----------
LR 0.001
train: bce: 0.013143, dice_loss: 0.229544, loss: 0.242687
val: bce: 0.012074, dice_loss: 0.221339, loss: 0.233413
EarlyStopping counter: 5 out of 30
5m 54s
Epoch 122/150
----------
LR 0.001
train: bce: 0.013237, dice_loss: 0.230082, loss: 0.243319
val: bce: 0.012210, dice_loss: 0.215630, loss: 0.227839
Validation loss decreased (0.229484 --> 0.227839).  Saving best model ...
5m 57s
Epoch 123/150
----------
LR 0.001
train: bce: 0.012240, dice_loss: 0.220882, loss: 0.233122
val: bce: 0.011475, dice_loss: 0.214029, loss: 0.225503
Validation loss decreased (0.227839 --> 0.225503).  Saving best model ...
5m 56s
Epoch 124/150
----------
LR 0.001
train: bce: 0.012634, dice_loss: 0.220716, loss: 0.233350
val: bce: 0.012112, dice_loss: 0.209504, loss: 0.221615
Validation loss decreased (0.225503 --> 0.221615).  Saving best model ...
5m 55s
Epoch 125/150
----------
LR 0.001
train: bce: 0.012743, dice_loss: 0.221763, loss: 0.234506
val: bce: 0.013635, dice_loss: 0.222273, loss: 0.235908
EarlyStopping counter: 1 out of 30
5m 59s
Epoch 126/150
----------
LR 0.001
train: bce: 0.012277, dice_loss: 0.221317, loss: 0.233594
val: bce: 0.011247, dice_loss: 0.209708, loss: 0.220955
Validation loss decreased (0.221615 --> 0.220955).  Saving best model ...
6m 3s
Epoch 127/150
----------
LR 0.001
train: bce: 0.012320, dice_loss: 0.218259, loss: 0.230580
val: bce: 0.014233, dice_loss: 0.232921, loss: 0.247153
EarlyStopping counter: 1 out of 30
5m 59s
Epoch 128/150
----------
LR 0.001
train: bce: 0.012737, dice_loss: 0.223669, loss: 0.236406
val: bce: 0.013641, dice_loss: 0.218407, loss: 0.232049
EarlyStopping counter: 2 out of 30
6m 3s
Epoch 129/150
----------
LR 0.001
train: bce: 0.012516, dice_loss: 0.219514, loss: 0.232029
val: bce: 0.011916, dice_loss: 0.219179, loss: 0.231095
EarlyStopping counter: 3 out of 30
5m 56s
Epoch 130/150
----------
LR 0.001
train: bce: 0.012300, dice_loss: 0.215342, loss: 0.227642
val: bce: 0.011695, dice_loss: 0.210447, loss: 0.222142
EarlyStopping counter: 4 out of 30
5m 55s
Epoch 131/150
----------
LR 0.001
train: bce: 0.012299, dice_loss: 0.216309, loss: 0.228608
val: bce: 0.013936, dice_loss: 0.215737, loss: 0.229673
EarlyStopping counter: 5 out of 30
5m 57s
Epoch 132/150
----------
LR 0.001
train: bce: 0.012678, dice_loss: 0.219535, loss: 0.232213
val: bce: 0.011860, dice_loss: 0.206925, loss: 0.218786
Validation loss decreased (0.220955 --> 0.218786).  Saving best model ...
5m 55s
Epoch 133/150
----------
LR 0.001
train: bce: 0.012699, dice_loss: 0.218201, loss: 0.230900
val: bce: 0.011889, dice_loss: 0.217410, loss: 0.229299
EarlyStopping counter: 1 out of 30
5m 55s
Epoch 134/150
----------
LR 0.001
train: bce: 0.012446, dice_loss: 0.214625, loss: 0.227071
val: bce: 0.010993, dice_loss: 0.201019, loss: 0.212011
Validation loss decreased (0.218786 --> 0.212011).  Saving best model ...
5m 55s
Epoch 135/150
----------
LR 0.001
train: bce: 0.012398, dice_loss: 0.214436, loss: 0.226834
val: bce: 0.011388, dice_loss: 0.211267, loss: 0.222655
EarlyStopping counter: 1 out of 30
5m 59s
Epoch 136/150
----------
LR 0.001
train: bce: 0.011844, dice_loss: 0.210843, loss: 0.222687
val: bce: 0.010412, dice_loss: 0.197831, loss: 0.208243
Validation loss decreased (0.212011 --> 0.208243).  Saving best model ...
5m 55s
Epoch 137/150
----------
LR 0.001
train: bce: 0.011871, dice_loss: 0.213390, loss: 0.225261
val: bce: 0.010714, dice_loss: 0.200974, loss: 0.211688
EarlyStopping counter: 1 out of 30
5m 54s
Epoch 138/150
----------
LR 0.001
train: bce: 0.012220, dice_loss: 0.210063, loss: 0.222283
val: bce: 0.012881, dice_loss: 0.211151, loss: 0.224033
EarlyStopping counter: 2 out of 30
5m 54s
Epoch 139/150
----------
LR 0.001
train: bce: 0.011571, dice_loss: 0.207951, loss: 0.219523
val: bce: 0.010754, dice_loss: 0.195436, loss: 0.206190
Validation loss decreased (0.208243 --> 0.206190).  Saving best model ...
5m 55s
Epoch 140/150
----------
LR 0.001
train: bce: 0.011923, dice_loss: 0.210383, loss: 0.222306
val: bce: 0.011143, dice_loss: 0.193960, loss: 0.205103
Validation loss decreased (0.206190 --> 0.205103).  Saving best model ...
5m 60s
Epoch 141/150
----------
LR 0.001
train: bce: 0.011270, dice_loss: 0.202301, loss: 0.213571
val: bce: 0.010283, dice_loss: 0.192956, loss: 0.203239
Validation loss decreased (0.205103 --> 0.203239).  Saving best model ...
6m 3s
Epoch 142/150
----------
LR 0.001
train: bce: 0.011632, dice_loss: 0.205919, loss: 0.217551
val: bce: 0.014280, dice_loss: 0.207513, loss: 0.221793
EarlyStopping counter: 1 out of 30
5m 55s
Epoch 143/150
----------
LR 0.001
train: bce: 0.011153, dice_loss: 0.198917, loss: 0.210070
val: bce: 0.012672, dice_loss: 0.203828, loss: 0.216500
EarlyStopping counter: 2 out of 30
5m 56s
Epoch 144/150
----------
LR 0.001
train: bce: 0.011181, dice_loss: 0.199840, loss: 0.211021
val: bce: 0.011541, dice_loss: 0.189480, loss: 0.201021
Validation loss decreased (0.203239 --> 0.201021).  Saving best model ...
5m 56s
Epoch 145/150
----------
LR 0.001
train: bce: 0.010810, dice_loss: 0.194981, loss: 0.205790
val: bce: 0.011136, dice_loss: 0.195539, loss: 0.206676
EarlyStopping counter: 1 out of 30
5m 56s
Epoch 146/150
----------
LR 0.001
train: bce: 0.011202, dice_loss: 0.198357, loss: 0.209558
val: bce: 0.011906, dice_loss: 0.231970, loss: 0.243876
EarlyStopping counter: 2 out of 30
5m 57s
Epoch 147/150
----------
LR 0.001
train: bce: 0.010839, dice_loss: 0.197316, loss: 0.208155
val: bce: 0.010154, dice_loss: 0.203015, loss: 0.213169
EarlyStopping counter: 3 out of 30
5m 55s
Epoch 148/150
----------
LR 0.001
train: bce: 0.010954, dice_loss: 0.198065, loss: 0.209019
val: bce: 0.010760, dice_loss: 0.198204, loss: 0.208963
EarlyStopping counter: 4 out of 30
5m 55s
Epoch 149/150
----------
LR 0.001
train: bce: 0.011165, dice_loss: 0.194849, loss: 0.206014
val: bce: 0.010712, dice_loss: 0.190295, loss: 0.201007
Validation loss decreased (0.201021 --> 0.201007).  Saving best model ...
5m 55s
Epoch 150/150
----------
LR 0.001
train: bce: 0.010603, dice_loss: 0.193389, loss: 0.203992
val: bce: 0.010625, dice_loss: 0.207419, loss: 0.218044
EarlyStopping counter: 1 out of 30
5m 55s
Best val loss: 0.201007
----------------------------------------------------------------
Fine Tuning of ResNetUnet starts ...
----------------------------------------------------------------
Epoch 1/50
----------
LR 1e-05
train: bce: 0.010865, dice_loss: 0.193529, loss: 0.204394
val: bce: 0.012113, dice_loss: 0.192256, loss: 0.204370
Validation loss decreased (inf --> 0.204370).  Saving best model ...
7m 35s
Epoch 2/50
----------
LR 1e-05
train: bce: 0.010684, dice_loss: 0.190492, loss: 0.201176
val: bce: 0.009939, dice_loss: 0.189978, loss: 0.199917
Validation loss decreased (0.204370 --> 0.199917).  Saving best model ...
7m 32s
Epoch 3/50
----------
LR 1e-05
train: bce: 0.009882, dice_loss: 0.183708, loss: 0.193590
val: bce: 0.009607, dice_loss: 0.186822, loss: 0.196429
Validation loss decreased (0.199917 --> 0.196429).  Saving best model ...
7m 31s
Epoch 4/50
----------
LR 1e-05
train: bce: 0.009674, dice_loss: 0.181859, loss: 0.191533
val: bce: 0.010223, dice_loss: 0.186009, loss: 0.196232
Validation loss decreased (0.196429 --> 0.196232).  Saving best model ...
7m 31s
Epoch 5/50
----------
LR 1e-05
train: bce: 0.009724, dice_loss: 0.182972, loss: 0.192696
val: bce: 0.009387, dice_loss: 0.179684, loss: 0.189071
Validation loss decreased (0.196232 --> 0.189071).  Saving best model ...
7m 31s
Epoch 6/50
----------
LR 1e-05
train: bce: 0.009519, dice_loss: 0.180166, loss: 0.189685
val: bce: 0.009470, dice_loss: 0.176794, loss: 0.186265
Validation loss decreased (0.189071 --> 0.186265).  Saving best model ...
7m 33s
Epoch 7/50
----------
LR 1e-05
train: bce: 0.009266, dice_loss: 0.175475, loss: 0.184741
val: bce: 0.009321, dice_loss: 0.175559, loss: 0.184881
Validation loss decreased (0.186265 --> 0.184881).  Saving best model ...
7m 30s
Epoch 8/50
----------
LR 1e-05
train: bce: 0.009175, dice_loss: 0.173834, loss: 0.183010
val: bce: 0.009039, dice_loss: 0.171384, loss: 0.180423
Validation loss decreased (0.184881 --> 0.180423).  Saving best model ...
7m 30s
Epoch 9/50
----------
LR 1e-05
train: bce: 0.009408, dice_loss: 0.176370, loss: 0.185778
val: bce: 0.009401, dice_loss: 0.178319, loss: 0.187720
EarlyStopping counter: 1 out of 30
7m 29s
Epoch 10/50
----------
LR 1e-05
train: bce: 0.009218, dice_loss: 0.174582, loss: 0.183800
val: bce: 0.009683, dice_loss: 0.177370, loss: 0.187054
EarlyStopping counter: 2 out of 30
7m 30s
Epoch 11/50
----------
LR 1e-05
train: bce: 0.009102, dice_loss: 0.171546, loss: 0.180648
val: bce: 0.008948, dice_loss: 0.168109, loss: 0.177058
Validation loss decreased (0.180423 --> 0.177058).  Saving best model ...
7m 31s
Epoch 12/50
----------
LR 1e-05
train: bce: 0.008916, dice_loss: 0.170129, loss: 0.179044
val: bce: 0.008778, dice_loss: 0.166505, loss: 0.175283
Validation loss decreased (0.177058 --> 0.175283).  Saving best model ...
7m 31s
Epoch 13/50
----------
LR 1e-05
train: bce: 0.009000, dice_loss: 0.168930, loss: 0.177930
val: bce: 0.008699, dice_loss: 0.164613, loss: 0.173312
Validation loss decreased (0.175283 --> 0.173312).  Saving best model ...
7m 30s
Epoch 14/50
----------
LR 1e-05
train: bce: 0.008843, dice_loss: 0.169019, loss: 0.177862
val: bce: 0.008847, dice_loss: 0.169945, loss: 0.178792
EarlyStopping counter: 1 out of 30
7m 29s
Epoch 15/50
----------
LR 1e-05
train: bce: 0.008914, dice_loss: 0.169536, loss: 0.178450
val: bce: 0.008579, dice_loss: 0.166530, loss: 0.175110
EarlyStopping counter: 2 out of 30
7m 29s
Epoch 16/50
----------
LR 1e-05
train: bce: 0.008678, dice_loss: 0.167985, loss: 0.176663
val: bce: 0.008515, dice_loss: 0.169926, loss: 0.178440
EarlyStopping counter: 3 out of 30
7m 30s
Epoch 17/50
----------
LR 1e-05
train: bce: 0.008748, dice_loss: 0.167673, loss: 0.176421
val: bce: 0.008642, dice_loss: 0.164268, loss: 0.172910
Validation loss decreased (0.173312 --> 0.172910).  Saving best model ...
7m 31s
Epoch 18/50
----------
LR 1e-05
train: bce: 0.008683, dice_loss: 0.166142, loss: 0.174824
val: bce: 0.008813, dice_loss: 0.162820, loss: 0.171633
Validation loss decreased (0.172910 --> 0.171633).  Saving best model ...
7m 32s
Epoch 19/50
----------
LR 1e-05
train: bce: 0.008744, dice_loss: 0.166227, loss: 0.174971
val: bce: 0.008640, dice_loss: 0.170250, loss: 0.178890
EarlyStopping counter: 1 out of 30
7m 30s
Epoch 20/50
----------
LR 1e-05
train: bce: 0.008638, dice_loss: 0.165817, loss: 0.174456
val: bce: 0.008508, dice_loss: 0.166397, loss: 0.174905
EarlyStopping counter: 2 out of 30
7m 30s
Epoch 21/50
----------
LR 1e-05
train: bce: 0.008645, dice_loss: 0.164777, loss: 0.173422
val: bce: 0.008729, dice_loss: 0.167242, loss: 0.175971
EarlyStopping counter: 3 out of 30
7m 29s
Epoch 22/50
----------
LR 1e-05
train: bce: 0.008600, dice_loss: 0.164225, loss: 0.172825
val: bce: 0.008624, dice_loss: 0.162839, loss: 0.171463
Validation loss decreased (0.171633 --> 0.171463).  Saving best model ...
7m 30s
Epoch 23/50
----------
LR 1e-05
train: bce: 0.008506, dice_loss: 0.162118, loss: 0.170624
val: bce: 0.008375, dice_loss: 0.160192, loss: 0.168567
Validation loss decreased (0.171463 --> 0.168567).  Saving best model ...
7m 30s
Epoch 24/50
----------
LR 1e-05
train: bce: 0.008372, dice_loss: 0.161243, loss: 0.169615
val: bce: 0.008525, dice_loss: 0.162957, loss: 0.171482
EarlyStopping counter: 1 out of 30
7m 30s
Epoch 25/50
----------
LR 1e-05
train: bce: 0.008479, dice_loss: 0.162410, loss: 0.170889
val: bce: 0.008486, dice_loss: 0.165366, loss: 0.173851
EarlyStopping counter: 2 out of 30
7m 31s
Epoch 26/50
----------
LR 1e-05
train: bce: 0.008454, dice_loss: 0.160950, loss: 0.169404
val: bce: 0.008550, dice_loss: 0.164016, loss: 0.172567
EarlyStopping counter: 3 out of 30
7m 30s
Epoch 27/50
----------
LR 1e-05
train: bce: 0.008652, dice_loss: 0.164479, loss: 0.173131
val: bce: 0.008835, dice_loss: 0.162022, loss: 0.170857
EarlyStopping counter: 4 out of 30
7m 30s
Epoch 28/50
----------
LR 1e-05
train: bce: 0.008382, dice_loss: 0.161558, loss: 0.169939
val: bce: 0.008151, dice_loss: 0.155770, loss: 0.163921
Validation loss decreased (0.168567 --> 0.163921).  Saving best model ...
7m 30s
Epoch 29/50
----------
LR 1e-05
train: bce: 0.008480, dice_loss: 0.162783, loss: 0.171264
val: bce: 0.008299, dice_loss: 0.164910, loss: 0.173209
EarlyStopping counter: 1 out of 30
7m 29s
Epoch 30/50
----------
LR 1e-05
train: bce: 0.008342, dice_loss: 0.160576, loss: 0.168917
val: bce: 0.008455, dice_loss: 0.165753, loss: 0.174208
EarlyStopping counter: 2 out of 30
7m 31s
Epoch 31/50
----------
LR 1e-05
train: bce: 0.008251, dice_loss: 0.159341, loss: 0.167591
val: bce: 0.008391, dice_loss: 0.157586, loss: 0.165977
EarlyStopping counter: 3 out of 30
7m 31s
Epoch 32/50
----------
LR 1e-05
train: bce: 0.008268, dice_loss: 0.158768, loss: 0.167036
val: bce: 0.008361, dice_loss: 0.158247, loss: 0.166608
EarlyStopping counter: 4 out of 30
7m 33s
Epoch 33/50
----------
LR 1e-05
train: bce: 0.008314, dice_loss: 0.157940, loss: 0.166254
val: bce: 0.008119, dice_loss: 0.160301, loss: 0.168421
EarlyStopping counter: 5 out of 30
7m 31s
Epoch 34/50
----------
LR 1e-05
train: bce: 0.008149, dice_loss: 0.157594, loss: 0.165743
val: bce: 0.008358, dice_loss: 0.160730, loss: 0.169089
EarlyStopping counter: 6 out of 30
7m 30s
Epoch 35/50
----------
LR 1e-05
train: bce: 0.008212, dice_loss: 0.157386, loss: 0.165599
val: bce: 0.008370, dice_loss: 0.165093, loss: 0.173462
EarlyStopping counter: 7 out of 30
7m 30s
Epoch 36/50
----------
LR 1e-05
train: bce: 0.008252, dice_loss: 0.156851, loss: 0.165103
val: bce: 0.008131, dice_loss: 0.155848, loss: 0.163979
EarlyStopping counter: 8 out of 30
7m 33s
Epoch 37/50
----------
LR 1e-05
train: bce: 0.008207, dice_loss: 0.155037, loss: 0.163244
val: bce: 0.008069, dice_loss: 0.150505, loss: 0.158575
Validation loss decreased (0.163921 --> 0.158575).  Saving best model ...
7m 32s
Epoch 38/50
----------
LR 1e-05
train: bce: 0.008066, dice_loss: 0.155472, loss: 0.163538
val: bce: 0.008094, dice_loss: 0.156145, loss: 0.164239
EarlyStopping counter: 1 out of 30
7m 33s
Epoch 39/50
----------
LR 1e-05
train: bce: 0.008266, dice_loss: 0.156505, loss: 0.164771
val: bce: 0.008098, dice_loss: 0.153607, loss: 0.161705
EarlyStopping counter: 2 out of 30
7m 32s
Epoch 40/50
----------
LR 1e-05
train: bce: 0.008021, dice_loss: 0.155030, loss: 0.163050
val: bce: 0.007760, dice_loss: 0.154632, loss: 0.162392
EarlyStopping counter: 3 out of 30
7m 31s
Epoch 41/50
----------
LR 1e-05
train: bce: 0.008094, dice_loss: 0.156011, loss: 0.164105
val: bce: 0.007885, dice_loss: 0.153938, loss: 0.161823
EarlyStopping counter: 4 out of 30
7m 30s
Epoch 42/50
----------
LR 1e-05
train: bce: 0.008017, dice_loss: 0.154378, loss: 0.162395
val: bce: 0.008025, dice_loss: 0.152064, loss: 0.160089
EarlyStopping counter: 5 out of 30
7m 30s
Epoch 43/50
----------
LR 1e-05
train: bce: 0.008171, dice_loss: 0.155258, loss: 0.163429
val: bce: 0.007933, dice_loss: 0.152478, loss: 0.160411
EarlyStopping counter: 6 out of 30
7m 30s
Epoch 44/50
----------
LR 1e-05
train: bce: 0.007963, dice_loss: 0.153415, loss: 0.161378
val: bce: 0.008063, dice_loss: 0.152723, loss: 0.160786
EarlyStopping counter: 7 out of 30
7m 32s
Epoch 45/50
----------
LR 1e-05
train: bce: 0.008016, dice_loss: 0.152703, loss: 0.160719
val: bce: 0.007901, dice_loss: 0.151068, loss: 0.158970
EarlyStopping counter: 8 out of 30
7m 30s
Epoch 46/50
----------
LR 1e-05
train: bce: 0.007907, dice_loss: 0.151808, loss: 0.159715
val: bce: 0.007875, dice_loss: 0.154292, loss: 0.162166
EarlyStopping counter: 9 out of 30
7m 31s
Epoch 47/50
----------
LR 1e-05
train: bce: 0.007902, dice_loss: 0.153273, loss: 0.161175
val: bce: 0.007662, dice_loss: 0.156487, loss: 0.164149
EarlyStopping counter: 10 out of 30
7m 30s
Epoch 48/50
----------
LR 1e-05
train: bce: 0.008030, dice_loss: 0.153648, loss: 0.161678
val: bce: 0.007662, dice_loss: 0.148245, loss: 0.155907
Validation loss decreased (0.158575 --> 0.155907).  Saving best model ...
7m 30s
Epoch 49/50
----------
LR 1e-05
train: bce: 0.007985, dice_loss: 0.151428, loss: 0.159413
val: bce: 0.007950, dice_loss: 0.156806, loss: 0.164756
EarlyStopping counter: 1 out of 30
7m 34s
Epoch 50/50
----------
LR 1e-05
train: bce: 0.007902, dice_loss: 0.151978, loss: 0.159880
val: bce: 0.007890, dice_loss: 0.153805, loss: 0.161695
EarlyStopping counter: 2 out of 30
7m 34s
Best val loss: 0.155907
(torch) chan@chan-desktop:~/Desktop/DLD1$ python test.py --model resnetunet --metric-dataset-type oversample
----------------------------------------------------------------
The number of test set: 1348
----------------------------------------------------------------
----------
The Evaluation Starts ...
----------
The total samples: 1348
The average dice score is 0.9271500706672668.
The number of cancer samples: 125
The average dice score of the slices which have cancer is 0.4270479381084442.
The number of correct cases when the prediction predicts some poriton of the cancer: 75
The number of incorrect cases when the prediction predicts some poriton of the cancer: 2
The number of cases when the prediction predicts no cancer but it has cancer: 48
The number of non-cancer samples: 1223
The average dice score of the slices which have non-cancer is 0.9782642722129822.
The number of cases when the prediction predicts no cancer when it has no cancer: 1194
The number of cases when the prediction predicts cancer when it has no cancer: 29
0m 29s
